---
layout: single
title:  "SQL - 2"
categories: Blog
excerpt: "SQL의 create와 drop, sequence 제약조건을 다뤘습니다."
tags: [SQL, blog, database, oracle, constraint]
toc: true
toc_sticky: true
toc_label : 목차
toc_icon: "fas fa-tasks"
author_profile: false
sidebar:
nav: "docs"


---
[Google](https://google.com){: .btn .btn--warning}


# Sequence

<hr/> 

```sql

	create sequence test_seq
	시퀀스 'test_seq'를 생성합니다.

	start with 1000
	시작 값으로 1000을 설정합니다.

	maxvalue 9999
	최대 값으로 9999를 설정합니다.

	increment by 1
	증가 값으로 1을 설정합니다.

	nocache
	값을 캐시하지 않습니다.

	nocycle
	최대 값에 도달한 후 순환하지 않습니다.

	select test_seq.currval from dual;
	현재 'test_seq' 시퀀스의 값을 조회합니다.

	select test_seq.nextval from dual;
	'test_seq' 시퀀스의 다음 값을 조회합니다.

	select 1000 + 5 from dual;
	1000에 5를 더한 값을 조회합니다.

	select sysdate from dual;
	현재 시스템 날짜를 조회합니다.
	

```


## drop / flashback

```sql

	select * from tab;
	select * from product;
	테이블의 모든 데이터를 조회합니다.

	select * from recyclebin; 
	휴지통에 있는 객체들의 정보를 조회합니다.

	purge recyclebin;
	휴지통의 모든 객체를 삭제합니다.

	drop table product purge;
	테이블을 삭제함과 동시에 영구히 제거합니다.

	flashback table product to before drop;
	삭제된 'product' 테이블을 삭제 전 상태로 복원합니다.


```

## Oracle의 제약조건

```sql

	오라클 제약조건
	테이블의 컬럼에 대하여 특정 조건을 부여하는 형식입니다.

	1. primary key	기본키 (unique + not null)
	- 여러 줄의 데이터중에서 하나만 가져올 수 있는 키입니다.

	2. unique	고유키 (중복될 수 없음)
	- 중복되면 안되는 속성 (상품의 이름)입니다.

	3. not null 빈 값을 넣을 수 없습니다.
	- 일반 컬럼은 값을 넣지 않을 수도 있습니다 (null)

	4. default	기본값을 지정합니다.
	- 직접 insert 하지 않아도 들어가는 기본값을 지정합니다.
	- 등록날짜
	- 레코드의 고유 번호

	5. check 특정 조건을 만족해야 합니다.
	- 특정 범위, 특정 조건을 만족하는 값만 넣을 수 있습니다.
	- 성별, 가격, 날짜

	6. foreign key	다른 테이블의 값을 참조해야 합니다.
	- 이미 등록된 다른 테이블의 값이 있어야 등록할 수 있습니다.

	  ===========================================

	일정 범위의 숫자를 이용하여 레코드를 관리할 때
	겹치지 않은 숫자를 자동으로 내어주는 데이터베이스 객체

	create sequence [시퀀스이름]
		start with [시작값]
		maxvalue [최대값]
		increment by [증감값]
		nocache
		nocycle;

	-- 현재 마지막으로 사용한 번호
	select [시퀀스이름].currval from dual;

	-- 아직 사용하지 않은 다음 번호
	select [시퀀스이름].nextval from dual;


```



## 제약조건 걸기 예시

```sql

	drop sequence product_seq;
	'product_seq' 시퀀스를 삭제합니다.

	drop table product;
	'product' 테이블을 삭제합니다.
	-- 새로 만들 때 모두 초기화 후 새로 생성하기 위해 맨위에 작성해둠.


	create sequence product_seq
	'product_seq' 시퀀스를 생성합니다.

	start with 1
	시퀀스의 시작 값으로 1을 설정합니다.

	maxvalue 999999999
	시퀀스의 최대 값으로 999,999,999 를 설정합니다.

	increment by 1
	시퀀스의 증가 값으로 1을 설정합니다.

	nocache
	시퀀스의 값을 캐시하지 않습니다.

	nocycle
	시퀀스가 최대 값에 도달한 후 순환하지 않습니다.

	create table product
	'product' 테이블을 생성합니다.

	idx number default product_seq.nextval primary key,
	'idx'라는 숫자 타입의 컬럼을 생성하고, 
	기본값으로 'product_seq' 시퀀스의 다음 값을 사용하며, 
	이 컬럼을 기본 키로 설정합니다.

	name varchar2(100) unique,
	'name'이라는 최대 길이 100인 문자열 타입의 컬럼을 생성하고, 
	값이 고유해야 함을 지정합니다.

	price number check(price >= 100),
	'price'라는 숫자 타입의 컬럼을 생성하고, 
	값이 100 이상이어야 함을 지정합니다.

	expiryDate date check(expiryDate > to_date('2023/01/01', 'YYYY/MM/DD')),
	'expiryDate'라는 날짜 타입의 컬럼을 생성하고, 
	값이 '2023/01/01' 이후여야 함을 지정합니다.

	memo varchar2(2000) not null
	'memo'라는 최대 길이 2000인 문자열 타입의 컬럼을 생성하고, 
	값이 반드시 있어야 함을 지정합니다.




```

